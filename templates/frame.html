<!DOCTYPE html>
<html>

<head>
    <title>S.N.E.E.D. - {{ frame_name }}</title>
    <link rel="stylesheet" type="text/css" href="/static/style.css" />
    <link rel="stylesheet" type="text/css" href="/static/user-colors.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&family=VT323&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    {% if background == "physics" -%}
    <script type="text/javascript" src="/static/matter.min.js"></script>
    {%- endif %}
</head>

<body id="overlay" data-frame="{{ view_id }}" {% if background=="physics" %} class="physics-background" {% endif %}>
    {% if background == "physics" -%}
    <canvas id="physics-canvas"></canvas>
    {%- endif %}

    <section id="live">
        <span id="live-icon" class="live-badge">LIVE</span>
        <span id="live-totals" class="live-badge">0</span>
    </section>

    <section id="attribution">
        <span id="name">Mad at the Internet</span>
        · <span id="url">mati.live</span>
        · <span id="date">January 1st, 1970</span>
    </section>

    <section id="chat">
        <div id="chat-messages"></div>
        <div id="flyout">
            <div id="poll-ui"></div>
            <div id="superchat-ui"></div>
        </div>
    </section>

    <section id="show-message"></section>

    <script type="text/javascript" src="/static/script.js"></script>
    {% if background == "physics" -%}
    <script type="text/javascript" src="/static/background.js"></script>
    {%- endif %}
    <script>
        // Frame configuration
        window.FRAME_CONFIG = {
            viewId: "{{ view_id }}",
            frameName: "{{ frame_name }}",
            elements: {{ elements_json | safe }},
        background: {% if background != "" %} "{{ background }}"{% else %} null{% endif %},
        donationMatter: { { donation_matter_json | safe } }
        };

        // Hide elements not in this frame (if frame has specific elements)
        document.addEventListener('DOMContentLoaded', function () {
            const elements = window.FRAME_CONFIG.elements;
            if (elements && elements.length > 0) {
                // Frame specifies which elements to show
                const allSections = ['live', 'attribution', 'chat', 'show-message'];
                allSections.forEach(function (id) {
                    const el = document.getElementById(id);
                    if (el) {
                        // Map section IDs to element IDs
                        const elementId = id === 'show-message' ? 'featured' :
                            id === 'attribution' ? 'text' : id;
                        if (!elements.includes(elementId)) {
                            el.style.display = 'none';
                        }
                    }
                });
            }
        });
    </script>
</body>

</html>